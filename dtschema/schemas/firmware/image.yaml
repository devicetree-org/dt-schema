# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
# Copyright 2023 Google LLC

%YAML 1.2
---
$id: http://devicetree.org/schemas/firmware/image.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Binman firmware layout

maintainers:
  - Simon Glass <sjg@chromium.org>

description: |
  The image node provides a layout for firmware, used when packaging firmware
  from multiple projects. For now it just supports a very simple set of
  features, as a starting point for discussion.

  The Binman tool processes this node to produce a final image which can be
  loaded into suitable storage device. Documentation is at:

  https://u-boot.readthedocs.io/en/latest/develop/package/binman.html

  The current image-description format is here:

  https://u-boot.readthedocs.io/en/latest/develop/package/binman.html#image-description-format

  It is desirable to reference the image from the storage-device node, perhaps
  using an image-desc property:

    spiflash@0 {
      compatible = "spidev", "jedec,spi-nor";
      data,layout = <&image>;
    };

  Note that the intention is to change Binman to use whatever schema is agreed
  here.

properties:
  $nodename:
    pattern: "^[-a-z]+(-[0-9]+)?$"

  compatible:
    const: data,image

  "#address-cells":
    const: 1

  "#size-cells":
    const: 1

required:
  - compatible
  - "#address-cell"
  - "#size-cells"

additionalProperties: true

examples:
  - |
    firmware {
      image: image {
        compatible = "data,image";
        #address-cells = <1>;
        $size-cells = <1>;

        u-boot@0 {
          compatible = "data,u-boot";
          reg = <0 0xa0000>;
        };

        atf-bl31@0x100000 {
          compatible = "data,atf-bl31";
          reg = <0x100000 0x20000>;
        };
      };
    };
